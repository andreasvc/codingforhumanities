\documentclass[aspectratio=169,usenames,dvipsnames]{beamer}
\usepackage{preamble}
\title{Coding for Humanities, week 4}

\begin{document}

\begin{frame}
 \titlepage
\end{frame}

\begin{frame}{Last week}
    Dictionaries

    Functions

    Text (pre)processing
\end{frame}

\begin{frame}{Plan for today}
 \tableofcontents
\end{frame}

\section{Recap and last week's exercises}
\frame{\tableofcontents[currentsection]}

\subsection{Week 1: Arithmetic}
\begin{frame}[fragile]{Values}
    \begin{description}
        \item[Special] True, False, None
        \item[Numbers] -1, 2, 3.5, etc.
        \item[Strings] 'a', 'hello', "I'm"
    \end{description}
\end{frame}

\begin{frame}[fragile]{Variables}
    \begin{description}
        \item[Assignment] name = expression
        \item[Increment] number += 1
        \item[Expressions] number = 1 + 2 * other\_number + int('42')
    \end{description}
\end{frame}

\subsection{Week 2: Sequences, Ifs, Loops}
\begin{frame}[fragile]{Sequences}
    \begin{description}
        \item[Indexing/slicing] seq[0], seq[2:4]
        \item[Length] len(seq)
    \end{description}
\end{frame}
\begin{frame}[fragile]{Lists}
    \begin{description}
        \item[Lists in lists] the\_list[0][1]
        \item[Append] the\_list.append(item)
    \end{description}
\end{frame}
\begin{frame}[fragile]{Ifs}
    \begin{description}
        \item[Conditions] a == b, letter == 'a', number == 2
        \item[If] if condition: ...
    \end{description}
\end{frame}
\begin{frame}[fragile]{Loops}
    \begin{description}
        \item[For] for item in iterable: ...
    \end{description}
\end{frame}

\subsection{Week 3: Dictionaries and Functions}
\begin{frame}[fragile]{Dictionaries}
    \begin{description}
        \item[creation] example = {'a': 0, 'b': 1}
        \item[lookup] example['a']
    \end{description}
\end{frame}
\begin{frame}[fragile]{Functions}
    \begin{description}
        \item[Defining] def name(param1, ...): ...
        \item[Calling] name(arg1, ...)
        \item[Return value] return
    \end{description}
\end{frame}

\begin{frame}{Learning to program is learning a language}
\begin{columns}[T]
\column{0.5\linewidth}
Similarities:
\begin{itemize}
	\item Need to memorize \structure{vocabulary}.
	\item Follow \structure{grammar} rules
	\item Practice reading \\
			and especially \structure{writing}.
	\item Recognize and use \structure{idioms}.
	\item Don't be afraid to make mistakes, \\
		you only improve by trying.
\end{itemize}
\column{0.5\linewidth}
\pause Differences:
\begin{itemize}
	\item No ambiguity, subtext, etc.
	\item Only commands, no description etc.
	\item The computer will not guess what you are trying to say.
	\item The computer gives immediate feedback.
\end{itemize}
\end{columns}
\end{frame}

% list comprehensions!

\subsection{Exercises}
\begin{frame}{Make 3rd sg form}
The third person singular verb form in English is distinguished by the suffix
-s, which is added to the stem of the infinitive form: run $\rightarrow$ runs.
A simple set of rules can be given as follows:
\begin{enumerate}
    \item If the verb ends in y, remove it and add ies
    \item If the verb ends in o, ch, s, sh, x or z, add es
    \item By default just add s
\end{enumerate}
\end{frame}

\begin{frame}[fragile]{Make 3rd sg form}
\begin{lstlisting}
def make_3sg_form(verb):
    if verb.endswith('y'):
        return verb[:-1] + 'ies'
    elif verb.endswith(('o', 's', 'x', 'z', 'ch', 'sh')):
        return verb + 'es'
    else:
        return verb + 's'
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{extract\_dialogue}
\scriptsize
\begin{verbatim}
ACT I. Scene I.
Verona. A public place.

Enter Sampson and Gregory (with swords and bucklers) of the house
of Capulet.


  Samp. Gregory, on my word, we'll not carry coals.

  Greg. No, for then we should be colliers.

  Samp. I mean, an we be in choler, we'll draw.
[...]

  Greg. 'Tis well thou art not fish; if thou hadst, thou hadst
    been poor-John. Draw thy tool! Here comes two of the house of
    Montagues.

           Enter two other Servingmen [Abram and Balthasar].


  Samp. My naked weapon is out. Quarrel! I will back thee.
[...]
\end{verbatim}
\end{frame}

\begin{frame}[fragile]{extract\_dialogue}
    Approach:
    \begin{enumerate}
        \item Split paragraphs
        \item Loop over paragraphs
        \item Identify paragraphs with dialogue
        \item Split name and line
        \item Store in dictionary
    \end{enumerate}
\end{frame}

\begin{frame}[fragile]{extract\_dialogue}
\begin{lstlisting}
def extract_dialogue(filename):
    with open(filename) as infile:
        text = infile.read()
    paragraphs = text.split('\n\n')
    result = {}
    for para in paragraphs:
        # paragraphs with dialogue start with
        # a character name and period: 'Samp. ...'
        first_token = para.split()[0]
        if first_token.endswith('.'):
            name, line = para.split('.', 1)
            # remove leading/trailing spaces
            name = name.strip()
            if name not in result:
                result[name] = []
            result[name].append(line)
    return result
\end{lstlisting}
\end{frame}





\section{Working with files}
\frame{\tableofcontents[currentsection]}

\begin{frame}{Motivation}
    To do anything non-trivial,

    programs need to work with \structure{arbitrary data}

    \pause
    Therefore, need to learn how to:

	\begin{itemize}
		\item \structure{read} external data(sets) from disk as input,
		\item and \structure{write} results as output
	\end{itemize}

\end{frame}


\begin{frame}{Files and directories}
    \begin{itemize}
        \item Data is stored in \structure{files} as a sequence of bytes
        \item Files are part of \structure{directories} (folders)
        \item Directories may contain files and other directories. Ergo:
            \begin{itemize}
                \item The file system is a tree structure.
                \item The location of a file is a path through this tree.
            \end{itemize}
    \end{itemize}
\end{frame}

\begin{frame}{Paths}
    \begin{itemize}
        \item A path describes the location of a file
		\begin{itemize}
        \item In the simplest case, just the filename is enough to
            refer to a file in the same directory as your program/notebook:

            \texttt{example.txt}

        \item If a file is somewhere else, need to include directories:

            \texttt{data/example.txt}\\
            \texttt{data/novels/19thcentury/austen/emma.txt}
		\item Use .. to refer to the parent directory
		\end{itemize}
    \end{itemize}
    \structure{NB}: Windows uses \textbackslash instead of \texttt{/}. \\
        However, this causes problems, use \texttt{/} in Python!
\end{frame}

\begin{frame}{Why directories}
    % Motivate organization
    \begin{itemize}
        \item Directories are useful to organize your files
        \item Use short, sensible names
        \item Don't put everything in one big pile. \\
            For example: separate code, data, results
    \end{itemize}
    \pause 
    Learn to use your system's file manager (Finder, Explorer, etc.)
    \begin{itemize}
        \item Make directories
        \item Move/rename files
        \item etc.
    \end{itemize}
    
\end{frame}

\begin{frame}[fragile]{Messy and organized files}
\begin{columns}
\column{0.5\linewidth}
\begin{verbatim}
Untitled 1.pdf
Untitled 1(1).pdf
Untitled 1(2).pdf
Untitled 1(2)(2)_draft.pdf
Untitled 1(2)_draftFINAL.pdf
Untitled 1(2)_FINAL_comments.pdf
Untitled 1(2)_FINAL_REALLY_FINAL.pdf
Untitled 1(2)_FINAL_make_it_stop.pdf
Untitled 1(2)_lAST-mInUtE-ChAnGES.pdf
\end{verbatim}
\pause
\column{0.5\linewidth}
\begin{verbatim}
code/ ...
data/ ...
research/ ...
teaching/ ...
└── codingforhumanities/
    ├── lectures/
    │   ├── slides1.pdf
    │   ├── slides2.pdf
    │   └── fig/ ...
    ├── notebooks/
    │   ├── ...
    │   └── data/ ...
    └── syllabus/
        └── syllabus.pdf
\end{verbatim}
\end{columns}
\end{frame}


\section{Importing modules}
\frame{\tableofcontents[currentsection]}

\begin{frame}[fragile]{Importing modules}
To go beyond builtin functionality, use import:
\begin{lstlisting}
# import whole module:
import <module>
# or import a specific part:
from <module> import <function>
\end{lstlisting}

\pause
\begin{lstlisting}
In: import math
In: math.pi
Out: 3.141592653589793
In: from math import sqrt
In: sqrt(16)
4.0
\end{lstlisting}

Matter of preference/convention which you use:
\begin{itemize}
	\item math.pi: clear that pi comes from math module
	\item sqrt: less typing \dots
\end{itemize}
\end{frame}

\subsection{The Python standard library}
\begin{frame}[fragile]{The Python standard library}
	"Batteries included"

	\vspace{1em}
	Many useful functions

	\vspace{1em}
    See \url{https://docs.python.org/3/library/index.html}
\end{frame}

\begin{frame}[fragile]{Finding files}
    \begin{itemize}
        \item \structure{globbing}: matching a set of files with a search pattern.
        \item The most common operators are:
            \begin{itemize}
                \item \texttt{*} meaning ``match zero or more characters''
                \item \texttt{?} meaning ``match exactly one character''
            \end{itemize}
        \item The \texttt{glob} module offers pattern matching of files.
        %\item The glob library contains a function also called \texttt{glob}
		%	to match file patterns
        %\item e.g., \texttt{glob.glob('*.txt')} matches all files in the
        %    current directory whose names end with .txt.
    \end{itemize}
\pause
Example:
\begin{lstlisting}
In: from glob import glob
In: glob('Chapter*')
Out: ['Chapter 2 - Basic text processing.ipynb',
    'Chapter 1 - Getting started.ipynb',
    'Chapter 3 - Text analysis.ipynb',]
In: glob('data/*.txt')
Out: ['austen-emma.txt', 'world-domination.txt', 'evil-plans.txt']
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Counter}
\begin{itemize}
\item A Counter is a specialized dictionary for counting
\item values are (integer) counts; missing values are 0
\item Mathematical term: \structure{bag}, \structure{multiset}
\end{itemize}

\begin{lstlisting}
In: from collections import Counter
In: cnt = Counter(['the', 'cat', 'is', 'on', 'the', 'mat'])
In: cnt
Out: Counter({'the': 2, 'is': 1, 'mat': 1, 'on': 1, 'cat': 1})
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Counter: initialization}
Several ways to initialize a Counter:\\

\begin{lstlisting}
In: cnt = Counter()
In: cnt
Out: Counter()
In: cnt = Counter(['red', 'blue', 'red', 'blue', 'red'])
In: cnt
Out: Counter({'red': 3, 'blue': 2})
In: cnt = Counter({'red': 3, 'blue': 2})
In: cnt
Out: Counter({'red': 3, 'blue': 2})
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Word frequency counting}
\begin{lstlisting}
words = [...]       # Some list of words
counts = {}
\end{lstlisting}\pause
\begin{lstlisting}
for word in words:
    if word not in counts::
        counts:[word] = 0
	counts:[word] += 1
...
\end{lstlisting}
\pause
Better:
\begin{lstlisting}
from collections import Counter
counts: = Counter(words)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Counter: more methods}
\begin{lstlisting}
In: cnt = Counter(['red','blue','red','blue','red'])
In: cnt.most_common(1)
Out: [('red', 3)]
In: for item, count in cnt.most_common():
...     print(count, item)
3 red
2 blue
In: cnt.update(['red', 'blue', 'blue'])
In: cnt
Out: Counter({'red': 4, 'blue': 4})

\end{lstlisting}
%In: Counter('abracadabra').most_common(3)
%Out: [('a', 5), ('r', 2), ('b', 2)]
\end{frame}


\subsection{The Python data science ecosystem}
\begin{frame}[fragile]{The Python data science ecosystem}
    \begin{description}
        \item[Spacy] industrial-strength Natural Language Processing (NLP)
        \item[NLTK] "educational-strength" NLP ...
        \item[Matplotlib] low-level plots/visualization
        \item[Seaborn] easier plot interface
        \item[Pandas] work with tabular data
        \item[Scikit-learn] Machine learning: classification, clustering
        \item[gensim] Topic modeling (LDA).
    \end{description}

	
\end{frame}

\begin{frame}{Installing packages}
    \begin{itemize}
        \item Most of these are part of Anaconda distribution; already installed!

			(Exceptions: Spacy, gensim)
        \item Install conda packages with Anaconda Navigator \\
			(a kind of curated ``app store'')

            \url{https://docs.anaconda.com/anaconda/navigator/getting-started/\#navigator-managing-packages}

        \item Install other packages with \texttt{pip} \\
			(more advanced, much more packages)

            \url{https://www.puzzlr.org/install-packages-pip-conda-environment/}
    \end{itemize}
\end{frame}


\begin{frame}{Summary}
    \begin{itemize}
        \item Standard library
        \item Data science ecosystem
    \end{itemize}
\end{frame}

\end{document}
